---
import Button from "./Button.astro";
---

<nav id="header" class="pt-0 md:pt-10 text-[#94a3b8] bg-[#0F1219]">
  <div
    id="navbar"
    class="fixed top-0 flex justify-between items-center w-full px-4 sm:px-6 md:px-8 bg-transparent z-50 transition-all duration-300 md:py-1 pt-6"
  >
    <div class="flex">
      <img class="w-10 h-10 left-5" src="/public/favicon.svg" alt="" />
      <span id="elemental"
        class="hidden md:flex place-self-center hover:text-white text-white transition text-3xl md:text-lg lg:text-xl md:me-4 md:ms-4 lg:me-6 lg:ms-6 font-bold"
        >Elemental</span
      >
    </div>

    <!--Menú mobile -->
    <div class="flex gap-10 md:hidden">
      <button
        id="menu-toggle"
        class="md:hidden text-white focus:outline-none z-50"
      >
        <svg
          id="menu-icon"
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
        <svg
          id="close-icon"
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6 hidden"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!--Navegación -->
    <div
      id="menu"
      class="hidden md:block fixed md:relative top-0 left-0 w-full md:w-auto h-screen md:h-auto bg-[#0F1219] md:bg-transparent pt-20 md:pt-0"
    >
      <ul
        class="flex flex-col md:flex-row justify-center items-center text-lg gap-8 md:gap-4 h-full md:h-auto"
      >
        <li class="md:hidden lg:hidden xl:hidden my-8">
          <div class="flex">
            <img class="w-10 h-10 left-5" src="/public/favicon.svg" alt="" />
            <span
              class="place-self-center hover:text-white text-white transition text-3xl md:text-lg lg:text-xl md:me-4 md:ms-4 lg:me-6 lg:ms-6 font-bold"
              >Elemental</span
            >
          </div>
        </li>
        <li>
          <a
            href="#inicio"
            class="hover:text-white transition text-2xl md:text-base lg:text-lg md:me-4 md:ms-4 lg:me-6 lg:ms-6 font-extralight"
            >Inicio</a
          >
        </li>
        <li>
          <a
            href="#servicios"
            class="hover:text-white transition text-2xl md:text-base lg:text-lg md:me-4 md:ms-4 lg:me-6 lg:ms-6 font-extralight"
            >Servicios</a
          >
        </li>
        <li>
          <a
            href="#clientes"
            class="hover:text-white transition text-2xl md:text-base lg:text-lg md:me-4 md:ms-4 lg:me-6 lg:ms-6 font-extralight"
            >Clientes</a
          >
        </li>
        <li>
          <a
            href="#equipo"
            class="hover:text-white transition text-2xl md:text-base lg:text-lg md:me-4 md:ms-4 lg:me-6 lg:ms-6 font-extralight"
            >Equipo</a
          >
        </li>
        <li>
          <a
            href="#contacto"
            class="hover:text-white transition text-2xl md:text-base lg:text-lg md:me-4 md:ms-4 lg:me-6 lg:ms-6 font-extralight"
            >Contacto</a
          >
        </li>
        <li class="my-8"><Button href="#"> Solicitar una reunión </Button></li>
      </ul>
      <!-- <button class="absolute right-5 bg-blue-500 py-3 px-8 rounded-xl"><strong>Solicitar una reunión</strong></button> -->
    </div>
  </div>
</nav>

<script>
  const menuToggle = document.getElementById("menu-toggle");
  const menu = document.getElementById("menu");
  const menuIcon = document.getElementById("menu-icon");
  const closeIcon = document.getElementById("close-icon");
  const navbar = document.getElementById("navbar");

  // Toggle del menú móvil
  menuToggle.addEventListener("click", () => {
    menu.classList.toggle("hidden");
    menuIcon.classList.toggle("hidden");
    closeIcon.classList.toggle("hidden");
  });

  // Cerrar menú al hacer clic en un enlace
  const menuLinks = menu.querySelectorAll("a");
  menuLinks.forEach((link) => {
    link.addEventListener("click", () => {
      if (window.innerWidth < 768) {
        menu.classList.add("hidden");
        menuIcon.classList.remove("hidden");
        closeIcon.classList.add("hidden");
      }
    });
  });

  // Efecto scroll en navbar
  let lastScroll = 0;
  window.addEventListener("scroll", () => {
    const currentScroll = window.scrollY;

    if (currentScroll > 50) {
      navbar.classList.add("bg-[#0F1219]/95", "backdrop-blur-md");
    } else {
      navbar.classList.remove("bg-[#0F1219]/95", "backdrop-blur-md");
    }

    lastScroll = currentScroll;
  });

  // Smooth scroll para anclas con offset por navbar fijo
  function smoothScrollToHash(hash) {
    if (!hash) {
      window.scrollTo({ top: 0, behavior: "smooth" });
      return;
    }
    const id = hash.startsWith("#") ? hash.slice(1) : hash;
    const target = document.getElementById(id);
    if (!target) return;

    // calcular offset por navbar (altura) y un pequeño margen
    const navHeight = navbar ? navbar.getBoundingClientRect().height : 0;
    const targetY =
      target.getBoundingClientRect().top + window.scrollY - navHeight - 12;
    window.scrollTo({ top: Math.max(0, targetY), behavior: "smooth" });
  }

  // Interceptar clicks en cualquier enlace de ancla de la página
  document.querySelectorAll('a[href^="#"]').forEach((link) => {
    link.addEventListener("click", (ev) => {
      const href = link.getAttribute("href");
      if (!href) return;
      // Si es un hash, evitar comportamiento por defecto y smooth scroll
      if (href.startsWith("#")) {
        ev.preventDefault();
        // cerrar menú móvil si está abierto
        if (
          window.innerWidth < 768 &&
          menu &&
          !menu.classList.contains("hidden")
        ) {
          menu.classList.add("hidden");
          if (menuIcon) menuIcon.classList.remove("hidden");
          if (closeIcon) closeIcon.classList.add("hidden");
        }
        smoothScrollToHash(href);
      }
    });
  });
</script>
